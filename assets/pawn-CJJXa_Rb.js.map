{"version":3,"file":"pawn-CJJXa_Rb.js","sources":["../src/pieces/pawn.ts"],"sourcesContent":["// src/pieces/pawn.ts\nimport { Piece, PieceColor, PieceType, BoardInterface } from '../piece';\n\nexport class Pawn extends Piece {\n  public hasMoved: boolean = false;\n\n  constructor(color: PieceColor) {\n    super(color, PieceType.PAWN);\n  }\n\n  isValidMove(\n    fromX: number,\n    fromY: number,\n    toX: number,\n    toY: number,\n    board: BoardInterface,\n  ): boolean {\n    const direction = this.color === PieceColor.WHITE ? 1 : -1;\n    const startRow = this.color === PieceColor.WHITE ? 1 : 6;\n    const distanceY = (toY - fromY) * direction;\n    const distanceX = Math.abs(toX - fromX);\n\n    if (distanceX === 0 && distanceY === 1 && !board.getPiece(toX, toY)) {\n      if (\n        ((this.color === PieceColor.WHITE && toY === 7) ||\n          (this.color === PieceColor.BLACK && toY === 0)) &&\n        board.getPiece(fromX, fromY)?.type === PieceType.PAWN\n      ) {\n        this.handlePromotion(toX, toY, board);\n      }\n      return true;\n    }\n\n    if (\n      distanceX === 0 &&\n      distanceY === 2 &&\n      fromY === startRow &&\n      !board.getPiece(toX, toY) &&\n      !board.getPiece(fromX, fromY + direction)\n    ) {\n      board.updateEnPassantTarget(fromX, fromY, toX, toY, this);\n      return true;\n    }\n\n    if (distanceX === 1 && distanceY === 1) {\n      if (board.getPiece(toX, toY) && this.canCapture(toX, toY, board)) {\n        if (\n          (this.color === PieceColor.WHITE && toY === 7) ||\n          (this.color === PieceColor.BLACK &&\n            toY === 0 &&\n            board.getPiece(fromX, fromY)?.type === PieceType.PAWN)\n        ) {\n          this.handlePromotion(toX, toY, board);\n        }\n        return true;\n      }\n\n      if (board.isEnPassantMove(fromX, fromY, toX, toY)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  handlePromotion(toX: number, toY: number, board: BoardInterface): void {\n    const promotionDialog = document.getElementById(\n      'promotionDialog',\n    ) as HTMLDivElement;\n\n    if (promotionDialog) {\n      promotionDialog.style.display = 'block';\n\n      // DÃ©finir la fonction de promotion en capturant le contexte (x, y)\n      window.promote = (pieceType: string) => {\n        promotionDialog.style.display = 'none';\n        board.promotePawn(toX, toY, pieceType);\n      };\n    }\n  }\n}\n"],"names":[],"mappings":";;AAGO,MAAM,aAAa,KAAM,CAAA;AAAA,EACvB,QAAoB,GAAA,KAAA,CAAA;AAAA,EAE3B,YAAY,KAAmB,EAAA;AAC7B,IAAM,KAAA,CAAA,KAAA,EAAO,UAAU,IAAI,CAAA,CAAA;AAAA,GAC7B;AAAA,EAEA,WACE,CAAA,KAAA,EACA,KACA,EAAA,GAAA,EACA,KACA,KACS,EAAA;AACT,IAAA,MAAM,SAAY,GAAA,IAAA,CAAK,KAAU,KAAA,UAAA,CAAW,QAAQ,CAAI,GAAA,CAAA,CAAA,CAAA;AACxD,IAAA,MAAM,QAAW,GAAA,IAAA,CAAK,KAAU,KAAA,UAAA,CAAW,QAAQ,CAAI,GAAA,CAAA,CAAA;AACvD,IAAM,MAAA,SAAA,GAAA,CAAa,MAAM,KAAS,IAAA,SAAA,CAAA;AAClC,IAAA,MAAM,SAAY,GAAA,IAAA,CAAK,GAAI,CAAA,GAAA,GAAM,KAAK,CAAA,CAAA;AAEtC,IAAI,IAAA,SAAA,KAAc,KAAK,SAAc,KAAA,CAAA,IAAK,CAAC,KAAM,CAAA,QAAA,CAAS,GAAK,EAAA,GAAG,CAAG,EAAA;AACnE,MAAA,IAAA,CACI,KAAK,KAAU,KAAA,UAAA,CAAW,SAAS,GAAQ,KAAA,CAAA,IAC1C,KAAK,KAAU,KAAA,UAAA,CAAW,SAAS,GAAQ,KAAA,CAAA,KAC9C,MAAM,QAAS,CAAA,KAAA,EAAO,KAAK,CAAG,EAAA,IAAA,KAAS,UAAU,IACjD,EAAA;AACA,QAAK,IAAA,CAAA,eAAA,CAAgB,GAAK,EAAA,GAAA,EAAK,KAAK,CAAA,CAAA;AAAA,OACtC;AACA,MAAO,OAAA,IAAA,CAAA;AAAA,KACT;AAEA,IAAA,IACE,cAAc,CACd,IAAA,SAAA,KAAc,KACd,KAAU,KAAA,QAAA,IACV,CAAC,KAAM,CAAA,QAAA,CAAS,GAAK,EAAA,GAAG,KACxB,CAAC,KAAA,CAAM,SAAS,KAAO,EAAA,KAAA,GAAQ,SAAS,CACxC,EAAA;AACA,MAAA,KAAA,CAAM,qBAAsB,CAAA,KAAA,EAAO,KAAO,EAAA,GAAA,EAAK,KAAK,IAAI,CAAA,CAAA;AACxD,MAAO,OAAA,IAAA,CAAA;AAAA,KACT;AAEA,IAAI,IAAA,SAAA,KAAc,CAAK,IAAA,SAAA,KAAc,CAAG,EAAA;AACtC,MAAI,IAAA,KAAA,CAAM,QAAS,CAAA,GAAA,EAAK,GAAG,CAAA,IAAK,KAAK,UAAW,CAAA,GAAA,EAAK,GAAK,EAAA,KAAK,CAAG,EAAA;AAChE,QAAA,IACG,KAAK,KAAU,KAAA,UAAA,CAAW,SAAS,GAAQ,KAAA,CAAA,IAC3C,KAAK,KAAU,KAAA,UAAA,CAAW,SACzB,GAAQ,KAAA,CAAA,IACR,MAAM,QAAS,CAAA,KAAA,EAAO,KAAK,CAAG,EAAA,IAAA,KAAS,UAAU,IACnD,EAAA;AACA,UAAK,IAAA,CAAA,eAAA,CAAgB,GAAK,EAAA,GAAA,EAAK,KAAK,CAAA,CAAA;AAAA,SACtC;AACA,QAAO,OAAA,IAAA,CAAA;AAAA,OACT;AAEA,MAAA,IAAI,MAAM,eAAgB,CAAA,KAAA,EAAO,KAAO,EAAA,GAAA,EAAK,GAAG,CAAG,EAAA;AACjD,QAAO,OAAA,IAAA,CAAA;AAAA,OACT;AAAA,KACF;AAEA,IAAO,OAAA,KAAA,CAAA;AAAA,GACT;AAAA,EAEA,eAAA,CAAgB,GAAa,EAAA,GAAA,EAAa,KAA6B,EAAA;AACrE,IAAA,MAAM,kBAAkB,QAAS,CAAA,cAAA;AAAA,MAC/B,iBAAA;AAAA,KACF,CAAA;AAEA,IAAA,IAAI,eAAiB,EAAA;AACnB,MAAA,eAAA,CAAgB,MAAM,OAAU,GAAA,OAAA,CAAA;AAGhC,MAAO,MAAA,CAAA,OAAA,GAAU,CAAC,SAAsB,KAAA;AACtC,QAAA,eAAA,CAAgB,MAAM,OAAU,GAAA,MAAA,CAAA;AAChC,QAAM,KAAA,CAAA,WAAA,CAAY,GAAK,EAAA,GAAA,EAAK,SAAS,CAAA,CAAA;AAAA,OACvC,CAAA;AAAA,KACF;AAAA,GACF;AACF;;;;"}