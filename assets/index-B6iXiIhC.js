(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(i){if(i.ep)return;i.ep=!0;const n=t(i);fetch(i.href,n)}})();const J="modulepreload",Z=function(c){return"/chess-game/"+c},R={},M=function(e,t,s){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=a?.nonce||a?.getAttribute("nonce");i=Promise.allSettled(t.map(o=>{if(o=Z(o),o in R)return;R[o]=!0;const u=o.endsWith(".css"),P=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${P}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":J,u||(d.as="script"),d.crossOrigin="",d.href=o,l&&d.setAttribute("nonce",l),document.head.appendChild(d),u)return new Promise((k,Q)=>{d.addEventListener("load",k),d.addEventListener("error",()=>Q(new Error(`Unable to preload CSS for ${o}`)))})}))}function n(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return i.then(a=>{for(const l of a||[])l.status==="rejected"&&n(l.reason);return e().catch(n)})};async function D(c,e){switch(c){case h.PAWN:const{Pawn:t}=await M(async()=>{const{Pawn:o}=await Promise.resolve().then(()=>se);return{Pawn:o}},void 0);return new t(e);case h.ROOK:const{Rook:s}=await M(async()=>{const{Rook:o}=await Promise.resolve().then(()=>X);return{Rook:o}},void 0);return new s(e);case h.KNIGHT:const{Knight:i}=await M(async()=>{const{Knight:o}=await Promise.resolve().then(()=>Y);return{Knight:o}},void 0);return new i(e);case h.BISHOP:const{Bishop:n}=await M(async()=>{const{Bishop:o}=await Promise.resolve().then(()=>ee);return{Bishop:o}},void 0);return new n(e);case h.QUEEN:const{Queen:a}=await M(async()=>{const{Queen:o}=await Promise.resolve().then(()=>te);return{Queen:o}},void 0);return new a(e);case h.KING:const{King:l}=await M(async()=>{const{King:o}=await Promise.resolve().then(()=>ie);return{King:o}},void 0);return new l(e);default:throw new Error(`Type de pièce inconnu : ${c}`)}}var r=(c=>(c.WHITE="white",c.BLACK="black",c))(r||{}),h=(c=>(c.PAWN="pawn",c.ROOK="rook",c.KNIGHT="knight",c.BISHOP="bishop",c.QUEEN="queen",c.KING="king",c))(h||{});class w{constructor(e,t){this.color=e,this.type=t}isPathClear(e,t,s,i,n){const a=Math.sign(s-e),l=Math.sign(i-t);let o=e+a,u=t+l;for(;o!==s||u!==i;){if(n.getPiece(o,u)!==null)return!1;o+=a,u+=l}return!0}canCapture(e,t,s){const i=s.getPiece(e,t);return!i||i.color!==this.color}toData(){return{color:this.color,type:this.type}}static async fromData(e){return await D(e.type,e.color)}async clone(){return await D(this.type,this.color)}}class p extends w{hasMoved=!1;constructor(e){super(e,h.ROOK)}isValidMove(e,t,s,i,n){return!(e===s||t===i)||!this.isPathClear(e,t,s,i,n)?!1:this.canCapture(s,i,n)}toData(){return{...super.toData(),hasMoved:this.hasMoved}}static async fromData(e){const t=new p(e.color);return t.hasMoved=e.hasMoved,t}}const X=Object.freeze(Object.defineProperty({__proto__:null,Rook:p},Symbol.toStringTag,{value:"Module"}));class T extends w{constructor(e){super(e,h.KNIGHT)}isValidMove(e,t,s,i,n){const a=Math.abs(s-e),l=Math.abs(i-t);return(a===2&&l===1||a===1&&l===2)&&this.canCapture(s,i,n)}}const Y=Object.freeze(Object.defineProperty({__proto__:null,Knight:T},Symbol.toStringTag,{value:"Module"}));class E extends w{constructor(e){super(e,h.BISHOP)}isValidMove(e,t,s,i,n){return Math.abs(s-e)===Math.abs(i-t)&&this.isPathClear(e,t,s,i,n)?this.canCapture(s,i,n):!1}}const ee=Object.freeze(Object.defineProperty({__proto__:null,Bishop:E},Symbol.toStringTag,{value:"Module"}));class x extends w{constructor(e){super(e,h.QUEEN)}isValidMove(e,t,s,i,n){return(e===s||t===i||Math.abs(s-e)===Math.abs(i-t))&&this.isPathClear(e,t,s,i,n)?this.canCapture(s,i,n):!1}}const te=Object.freeze(Object.defineProperty({__proto__:null,Queen:x},Symbol.toStringTag,{value:"Module"}));class y extends w{hasMoved=!1;constructor(e){super(e,h.KING)}isValidMove(e,t,s,i,n){const a=Math.abs(s-e),l=Math.abs(i-t);if(a<=1&&l<=1)return this.canCapture(s,i,n)&&!n.isAdjacentToAnotherKing(s,i,this.color);if(!this.hasMoved&&l===0&&a===2){const o=s>e?1:-1,u=s>e?7:0,P=n.getPiece(u,t);if(P&&P instanceof p&&!P.hasMoved){for(let d=e+o;d!==s;d+=o)if(n.getPiece(d,t)||n.isSquareUnderAttack(d,t,this.color))return!1;return!n.isSquareUnderAttack(s,t,this.color)&&!n.isAdjacentToAnotherKing(s,i,this.color)}}return!1}}const ie=Object.freeze(Object.defineProperty({__proto__:null,King:y},Symbol.toStringTag,{value:"Module"}));class v extends w{hasMoved=!1;constructor(e){super(e,h.PAWN)}isValidMove(e,t,s,i,n){const a=this.color===r.WHITE?1:-1,l=this.color===r.WHITE?1:6,o=(i-t)*a,u=Math.abs(s-e);if(u===0&&o===1&&!n.getPiece(s,i))return(this.color===r.WHITE&&i===7||this.color===r.BLACK&&i===0)&&n.getPiece(e,t)?.type===h.PAWN&&this.handlePromotion(s,i,n),!0;if(u===0&&o===2&&t===l&&!n.getPiece(s,i)&&!n.getPiece(e,t+a))return n.updateEnPassantTarget(e,t,s,i,this),!0;if(u===1&&o===1){if(n.getPiece(s,i)&&this.canCapture(s,i,n))return(this.color===r.WHITE&&i===7||this.color===r.BLACK&&i===0&&n.getPiece(e,t)?.type===h.PAWN)&&this.handlePromotion(s,i,n),!0;if(n.isEnPassantMove(e,t,s,i))return!0}return!1}handlePromotion(e,t,s){const i=document.getElementById("promotionDialog");i&&(i.style.display="block",window.promote=n=>{i.style.display="none",s.promotePawn(e,t,n)})}}const se=Object.freeze(Object.defineProperty({__proto__:null,Pawn:v},Symbol.toStringTag,{value:"Module"}));let j=[],U=[];function C(c){const e=document.getElementById("gameMessage");e.textContent=c,e.style.display="block"}function G(c,e){switch(c){case h.PAWN:return e===r.WHITE?"♙":"♟";case h.ROOK:return e===r.WHITE?"♖":"♜";case h.KNIGHT:return e===r.WHITE?"♘":"♞";case h.BISHOP:return e===r.WHITE?"♗":"♝";case h.QUEEN:return e===r.WHITE?"♕":"♛";case h.KING:return e===r.WHITE?"♔":"♚";default:return""}}function S(c,e){const t=G(c,e);e===r.WHITE?j.push(t):U.push(t),ne()}function ne(){const c=document.getElementById("capturedWhite"),e=document.getElementById("capturedBlack");c&&(c.textContent=j.join(" ")),e&&(e.textContent=U.join(" "))}class W{grid;enPassantTarget=null;halfMoveCount=0;constructor(){this.grid=this.initializeBoard()}initializeBoard(){const e=Array(8).fill(null).map(()=>Array(8).fill(null));return e[0]=[new p(r.WHITE),new T(r.WHITE),new E(r.WHITE),new x(r.WHITE),new y(r.WHITE),new E(r.WHITE),new T(r.WHITE),new p(r.WHITE)],e[1]=Array(8).fill(null).map(()=>new v(r.WHITE)),e[7]=[new p(r.BLACK),new T(r.BLACK),new E(r.BLACK),new x(r.BLACK),new y(r.BLACK),new E(r.BLACK),new T(r.BLACK),new p(r.BLACK)],e[6]=Array(8).fill(null).map(()=>new v(r.BLACK)),e}isWithinBounds(e,t){return e>=0&&e<8&&t>=0&&t<8}getPiece(e,t){return this.grid[t][e]}getValidMoves(e,t){let s=null;if(this.isWithinBounds(e,t)&&(s=this.getPiece(e,t)),!s)return[];const i=[];for(let n=0;n<8;n++)for(let a=0;a<8;a++)s.isValidMove(e,t,a,n,this)&&i.push({x:a,y:n});return i}getKingInCheck(){return this.isKingInCheck(r.WHITE)?this.findKing(r.WHITE):this.isKingInCheck(r.BLACK)?this.findKing(r.BLACK):null}movePiece(e,t,s,i){if(!this.isWithinBounds(e,t)||!this.isWithinBounds(s,i)||["__proto__","constructor","prototype"].includes(t.toString())||["__proto__","constructor","prototype"].includes(i.toString()))return!1;const n=this.getPiece(e,t);if(n&&n.isValidMove(e,t,s,i,this)){const a=this.getPiece(s,i);if(a&&a.type===h.KING)return!1;if(n instanceof y&&Math.abs(s-e)===2)return this.isCastlingValid(n,e,t,s)?(this.handleCastling(s,t),!0):!1;if(n instanceof v&&this.isEnPassantMove(e,t,s,i)&&this.captureEnPassant(e,t,s,i),this.grid[i][s]=n,this.grid[t][e]=null,this.isKingInCheck(n.color))return this.grid[t][e]=n,this.grid[i][s]=a,!1;"hasMoved"in n&&(n.hasMoved=!0),this.updateEnPassantTarget(e,t,s,i,n),this.halfMoveCount=n.type===h.PAWN||a?0:this.halfMoveCount+1;const l=n.color===r.WHITE?r.BLACK:r.WHITE;return this.isCheckmate(l),!0}return!1}isCastlingValid(e,t,s,i){const n=i>t?1:-1,a=i>t?7:0,l=this.getPiece(a,s);if(!(l instanceof p)||l.hasMoved||e.hasMoved)return!1;for(let o=t+n;o!==i;o+=n)if(this.getPiece(o,s)||this.isSquareUnderAttack(o,s,e.color))return!1;return!this.isSquareUnderAttack(t,s,e.color)&&!this.isSquareUnderAttack(i,s,e.color)}handleCastling(e,t){e===6?this.getPiece(7,t)instanceof p&&this.movePiece(7,t,5,t):e===2&&this.getPiece(0,t)instanceof p&&this.movePiece(0,t,3,t)}updateEnPassantTarget(e,t,s,i,n){n instanceof v&&Math.abs(i-t)===2&&e===s?this.enPassantTarget={x:s,y:(t+i)/2}:this.enPassantTarget=null}captureEnPassant(e,t,s,i){const n=this.getPiece(e,t);if(this.isEnPassantMove(e,t,s,i)&&n instanceof v){const a=n.color===r.WHITE?-1:1,l=i+a,o=this.getPiece(s,l);if(o&&o.type===h.PAWN){this.grid[l][s]=null;const u={capturedWhite:[],capturedBlack:[]};return o.color===r.WHITE?u.capturedWhite.push(o.type):u.capturedBlack.push(o.type),S(o.type,o.color),u}}return null}isEnPassantMove(e,t,s,i){return this.enPassantTarget?this.getPiece(e,t)instanceof v&&s===this.enPassantTarget.x&&i===this.enPassantTarget.y&&Math.abs(e-s)===1&&Math.abs(t-i)===1:!1}promotePawn(e,t,s){const i=this.getPiece(e,t)?.color;if(i)switch(s){case"queen":this.grid[t][e]=new x(i);break;case"rook":this.grid[t][e]=new p(i);break;case"bishop":this.grid[t][e]=new E(i);break;case"knight":this.grid[t][e]=new T(i);break}}isKingInCheck(e){const t=this.findKing(e);if(!t)return!1;for(let s=0;s<8;s++)for(let i=0;i<8;i++){const n=this.getPiece(i,s);if(n&&n.color!==e&&n.isValidMove(i,s,t.x,t.y,this))return!0}return!1}isCheckmate(e){if(!this.isKingInCheck(e))return!1;for(let t=0;t<8;t++)for(let s=0;s<8;s++){const i=this.getPiece(s,t);if(i&&i.color===e){const n=this.getValidMoves(s,t);for(const a of n){const l=this.getPiece(a.x,a.y);this.grid[a.y][a.x]=i,this.grid[t][s]=null;const o=!this.isKingInCheck(e);if(this.grid[t][s]=i,this.grid[a.y][a.x]=l,o)return!1}}}return!0}isStalemate(e){if(this.isKingInCheck(e))return!1;for(let t=0;t<8;t++)for(let s=0;s<8;s++){const i=this.getPiece(s,t);if(i&&i.color===e){for(let n=0;n<8;n++)for(let a=0;a<8;a++)if(i.isValidMove(s,t,a,n,this)){const l=this.getPiece(a,n);this.grid[n][a]=i,this.grid[t][s]=null;const o=!this.isKingInCheck(e);if(this.grid[t][s]=i,this.grid[n][a]=l,o)return!1}}}return!0}findKing(e){for(let t=0;t<8;t++)for(let s=0;s<8;s++){const i=this.getPiece(s,t);if(i&&i instanceof y&&i.color===e)return{x:s,y:t}}return null}isKing(e,t){return this.getPiece(e,t)instanceof y}isSquareUnderAttack(e,t,s){for(let i=0;i<8;i++)for(let n=0;n<8;n++){const a=this.getPiece(n,i);if(a&&a.color!==s&&a.isValidMove(n,i,e,t,this))return!0}return!1}isInsufficientMaterial(){const e=this.grid.flat().filter(t=>t!==null);return e.length<=2?!0:e.length===3&&e.some(t=>t?.type===h.BISHOP||t?.type===h.KNIGHT)}isFiftyMoveRule(){return this.halfMoveCount>=50}setPiece(e,t,s){this.grid[t][e]=s}isMoveValid(e,t,s,i){const n=this.getPiece(e,t);if(!n||s<0||s>=8||i<0||i>=8||!n.isValidMove(e,t,s,i,this))return!1;const a=this.getPiece(s,i);return!(a&&a.color===n.color)}isCapture(e,t,s,i){const n=this.isWithinBounds(e,t)?this.getPiece(e,t):null,a=this.isWithinBounds(s,i)?this.getPiece(s,i):null;return n!==null&&a!==null&&n.color!==a.color}static async fromData(e){const t=new W;return t.grid=await Promise.all(e.grid.map(async s=>Promise.all(s.map(async i=>i?await w.fromData(i):null)))),t}toData(){return{grid:this.grid.map(e=>e.map(t=>t?t.toData():null))}}isAdjacentToAnotherKing(e,t,s){const i=[{dx:-1,dy:-1},{dx:-1,dy:0},{dx:-1,dy:1},{dx:0,dy:-1},{dx:0,dy:1},{dx:1,dy:-1},{dx:1,dy:0},{dx:1,dy:1}];for(const{dx:n,dy:a}of i){const l=e+n,o=t+a,u=this.isWithinBounds(l,o)?this.getPiece(l,o):null;if(u instanceof y&&u.color!==s)return!0}return!1}clone(){const e=new W;return e.grid=this.grid.map(t=>t.map(s=>s?Object.create(Object.getPrototypeOf(s),Object.getOwnPropertyDescriptors(s)):null)),e.enPassantTarget=this.enPassantTarget?{...this.enPassantTarget}:null,e.halfMoveCount=this.halfMoveCount,e}getPieceCount(){return this.grid.flat().filter(e=>e!==null).length}isGameOver(){return this.isCheckmate(r.WHITE)||this.isCheckmate(r.BLACK)||this.isStalemate(r.WHITE)||this.isStalemate(r.BLACK)||this.isInsufficientMaterial()?!0:this.isFiftyMoveRule()}getWinner(){return this.isCheckmate(r.BLACK)?r.WHITE:this.isCheckmate(r.WHITE)?r.BLACK:(this.isStalemate(r.WHITE)||this.isStalemate(r.BLACK)||this.isInsufficientMaterial()||this.isFiftyMoveRule(),null)}getPieces(){return this.grid.flat().filter(e=>e!==null)}}class re{board;aiWorker;constructor(){this.board=new W,this.aiWorker=new Worker(new URL("/chess-game/assets/ai.worker-DnGrvu_w.js",import.meta.url),{type:"module"})}getBoard(){return this.board}makeAIMove(){return new Promise(e=>{this.aiWorker.onmessage=s=>{const{bestMove:i,captureData:n}=s.data;i&&this.board.movePiece(i.fromX,i.fromY,i.toX,i.toY)&&n&&(n.capturedWhite.forEach(l=>S(l,r.WHITE)),n.capturedBlack.forEach(l=>S(l,r.BLACK))),e()};const t=this.board.toData();this.aiWorker.postMessage({boardData:t})})}}class ae{constructor(e,t,s){this.board=e,this.moveHandler=s,this.canvas=document.getElementById(t),this.context=this.canvas.getContext("2d"),this.tileSize=this.canvas.width/8,this.canvas.style.cursor="default",this.canvas.addEventListener("mousedown",this.handleMouseDown.bind(this)),this.canvas.addEventListener("mousemove",this.handleMouseMove.bind(this)),this.canvas.addEventListener("mouseup",this.handleMouseUp.bind(this))}canvas;context;tileSize;draggingPiece=null;startX=null;startY=null;highlightedMoves=[];kingInCheckPosition=null;animateMove(e,t,s,i,n){let l=0;const o=e*this.tileSize,u=t*this.tileSize,P=(s-e)*this.tileSize/10,d=(i-t)*this.tileSize/10,k=()=>{l<=10?(this.drawBoard(),this.context.fillStyle=n.color===r.WHITE?"white":"black",this.context.font="48px Arial",this.context.textAlign="center",this.context.textBaseline="middle",this.context.fillText(this.getPieceText(n),o+P*l+this.tileSize/2,u+d*l+this.tileSize/2),l++,requestAnimationFrame(k)):this.drawBoard()};k()}highlightValidMoves(e){this.context.fillStyle="rgba(0, 255, 0, 0.5)",e.forEach(t=>{this.context.fillRect(t.x*this.tileSize,t.y*this.tileSize,this.tileSize,this.tileSize)})}drawBoard(){const e=this.board.getKingInCheck();this.kingInCheckPosition=e?{x:e.x,y:e.y}:null,this.drawTiles(),this.drawPieces()}drawTiles(){for(let e=0;e<8;e++)for(let t=0;t<8;t++){let i=(t+e)%2===1?"#769656":"#eeeed2";this.kingInCheckPosition&&this.kingInCheckPosition.x===t&&this.kingInCheckPosition.y===e&&(i="#ff6347"),this.context.fillStyle=i,this.context.fillRect(t*this.tileSize,e*this.tileSize,this.tileSize,this.tileSize)}}drawPieces(){for(let e=0;e<8;e++)for(let t=0;t<8;t++){const s=this.board.getPiece(t,e);s&&this.drawPiece(s,t,e)}}drawPiece(e,t,s){this.context.fillStyle=e.color==="white"?"white":"black",this.context.font="48px Arial",this.context.textAlign="center",this.context.textBaseline="middle";const i=this.getPieceText(e);this.context.fillText(i,t*this.tileSize+this.tileSize/2,s*this.tileSize+this.tileSize/2)}getPieceText(e){switch(e.type){case"pawn":return e.color==="white"?"♙":"♟";case"rook":return e.color==="white"?"♖":"♜";case"knight":return e.color==="white"?"♘":"♞";case"bishop":return e.color==="white"?"♗":"♝";case"queen":return e.color==="white"?"♕":"♛";case"king":return e.color==="white"?"♔":"♚";default:return""}}handleMouseDown(e){const t=this.canvas.getBoundingClientRect(),s=Math.floor((e.clientX-t.left)/this.tileSize),i=Math.floor((e.clientY-t.top)/this.tileSize),n=this.board.getPiece(s,i);n&&(this.draggingPiece=n,this.startX=s,this.startY=i,this.canvas.style.cursor="grabbing",this.highlightedMoves=this.board.getValidMoves(s,i),this.drawBoard(),this.highlightValidMoves(this.highlightedMoves))}handleMouseMove(e){const t=this.canvas.getBoundingClientRect(),s=Math.floor((e.clientX-t.left)/this.tileSize),i=Math.floor((e.clientY-t.top)/this.tileSize);let n=null;if(this.board.isWithinBounds(s,i)&&(n=this.board.getPiece(s,i)),n&&!this.draggingPiece?this.canvas.style.cursor="pointer":this.draggingPiece||(this.canvas.style.cursor="default"),!this.draggingPiece)return;this.drawBoard(),this.highlightValidMoves(this.highlightedMoves);const a=e.clientX-t.left,l=e.clientY-t.top;this.context.fillStyle=this.draggingPiece.color==="white"?"white":"black",this.context.font="48px Arial",this.context.textAlign="center",this.context.textBaseline="middle";const o=this.getPieceText(this.draggingPiece);this.context.fillText(o,a,l)}handleMouseUp(e){if(!this.draggingPiece||this.startX===null||this.startY===null)return;const t=this.canvas.getBoundingClientRect(),s=Math.floor((e.clientX-t.left)/this.tileSize),i=Math.floor((e.clientY-t.top)/this.tileSize),n=this.moveHandler(this.startX,this.startY,s,i);this.draggingPiece=null,this.startX=null,this.startY=null,this.canvas.style.cursor="default",this.highlightedMoves=[],this.drawBoard(),n&&this.drawBoard()}}class q{constructor(e,t){this.initialTime=e,this.currentTime=e,this.onTimeUpdate=t}intervalId=null;currentTime;onTimeUpdate;isRunning=!1;start(){this.isRunning||(this.isRunning=!0,this.intervalId=window.setInterval(()=>{this.currentTime--,this.onTimeUpdate(this.currentTime),this.currentTime<=0&&(this.currentTime=0,this.stop(),this.onTimeUpdate(this.currentTime))},1e3))}stop(){this.isRunning&&(this.intervalId!==null&&(clearInterval(this.intervalId),this.intervalId=null),this.isRunning=!1)}reset(e){this.stop(),this.currentTime=e,this.onTimeUpdate(this.currentTime),this.start()}}const $=new re,g=$.getBoard(),ce=document.getElementById("moveHistory"),oe=document.getElementById("currentTurn"),le=document.getElementById("timer"),K=document.getElementById("passTurnButton"),V=document.getElementById("gameMessage"),b=document.getElementById("replayButton");let f=r.WHITE,A="playing",H=!1,_=[[]],O=!1,L=!1,m=new q(60,c=>F(c,r.WHITE)),B=new q(60,c=>F(c,r.BLACK));function F(c,e){e===f&&(le.textContent=`Temps restant: ${c}s`,c<=0&&!O&&I(`${f===r.WHITE?"Noir":"Blanc"} gagne par temps écoulé !`))}const z=new ae(g,"chessBoard",ge);z.drawBoard();m.start();function I(c){C(c),O=!0,b.style.display="block",m.isRunning&&m.stop(),B.isRunning&&B.stop()}function he(){V.textContent="",V.style.display="none"}async function N(){he(),f=f===r.WHITE?r.BLACK:r.WHITE,oe.textContent=`Tour actuel: ${f===r.WHITE?"Blanc":"Noir"}`,H=!1,K.disabled=f===r.BLACK,f===r.WHITE?(B.isRunning&&B.stop(),m.reset(60)):(m.isRunning&&m.stop(),B.reset(60)),(g.isKingInCheck(r.BLACK)||g.isKingInCheck(r.WHITE))&&(g.isCheckmate(r.BLACK)&&I("Échec et Mat ! Blanc gagne !"),g.isCheckmate(r.WHITE)&&I("Échec et Mat ! Noir gagne !")),g.isStalemate(f)&&I("Pat ! La partie est nulle."),g.isInsufficientMaterial()&&I("Matériel insuffisant pour continuer, partie nulle !"),g.isFiftyMoveRule()&&I("Règle des 50 coups, partie nulle !"),A==="playing"&&(A="playing"),_.push([]),f===r.BLACK&&await ue()}async function ue(){L=!0,await $.makeAIMove(),z.drawBoard(),L=!1,await N()}function de(c,e,t,s,i){const n=`${G(i,r.WHITE)} de (${c}, ${e}) à (${t}, ${s})`,a=document.createElement("li");a.textContent=n,ce.appendChild(a),_[_.length-1].push({fromX:c,fromY:e,toX:t,toY:s,pieceType:i})}function ge(c,e,t,s){if(A==="waiting"||H||O)return C("Veuillez attendre le prochain tour !"),!1;const i=g.getPiece(c,e),n=g.getPiece(t,s);if(!i||i.color!==f)return L||C(`C'est le tour de ${f===r.WHITE?"Blanc":"Noir"}`),!1;if(i.isValidMove(c,e,t,s,g)){if(g.movePiece(c,e,t,s))return H=!0,n&&S(n.type,n.color),de(c,e,t,s,i.type),z.animateMove(c,e,t,s,i),N(),!0;C("Mouvement invalide !")}return!1}K&&K.addEventListener("click",async c=>{c.preventDefault(),A==="playing"&&f===r.WHITE&&!g.isKingInCheck(r.WHITE)&&(C(`Tour passé pour ${f===r.WHITE?"Blanc":"Noir"}`),await N())});b&&b.addEventListener("click",()=>{location.reload()});
//# sourceMappingURL=index-B6iXiIhC.js.map
